<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>As_ctx (soteria.Soteria.Stats.As_ctx)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../../';
let search_urls = ['../../../db.js','../../../../sherlodoc.js'];
</script><script src="../../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">Index</a> &#x00BB; <a href="../../../index.html">soteria</a> &#x00BB; <a href="../../index.html">Soteria</a> &#x00BB; <a href="../index.html">Stats</a> &#x00BB; As_ctx</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Stats.As_ctx</span></code></h1><p>Module for manipulating statistics as a context using algebraic effects (that are hidden). All calls to any function in this module should happen only inside a function wrapped with <a href="#val-with_stats"><code>with_stats</code></a>, ensuring that the statistics are properly passed around.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-with_stats"><a href="#val-with_stats" class="anchor"></a><code><span><span class="keyword">val</span> with_stats : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../index.html#type-with_stats">with_stats</a></span></span></code></div><div class="spec-doc"><p><code>with_stats () f</code> runs function <code>f</code> and handles effects raised by the functions of this module such as <a href="#val-push_entry"><code>push_entry</code></a>, and returns a record containing the result of executing <code>f</code> together with the obtained statistics.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_stats_ignored"><a href="#val-with_stats_ignored" class="anchor"></a><code><span><span class="keyword">val</span> with_stats_ignored : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_stats_ignored () f</code> runs function <code>f</code> and handles effects raised by the functions of this module, but ignores their effect. This is to be used when the user does not wish to pay the (minor) performance cost of stats bookkeeping.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_stats_dumped"><a href="#val-with_stats_dumped" class="anchor"></a><code><span><span class="keyword">val</span> with_stats_dumped : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_stats_dumped () f</code> runs function <code>f</code> and handles effects raised by the functions of this module such as <a href="#val-push_entry"><code>push_entry</code></a>, and dumps the stats to the file specified by the current <code>field-Config.output_stats</code> if it is set, or ignores them otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push_entry"><a href="#val-push_entry" class="anchor"></a><code><span><span class="keyword">val</span> push_entry : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-stat_entry">stat_entry</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_entry name entry</code> adds the given statistic <code>entry</code> under the given name <code>name</code> to the current statistics context.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_int"><a href="#val-add_int" class="anchor"></a><code><span><span class="keyword">val</span> add_int : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_int name n</code> is <code>push_entry name (Int n)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-incr"><a href="#val-incr" class="anchor"></a><code><span><span class="keyword">val</span> incr : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>incr name</code> is <code>add_int name 1</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_float"><a href="#val-add_float" class="anchor"></a><code><span><span class="keyword">val</span> add_float : <span>string <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_float name f</code> is <code>push_entry name (Float f)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_time_of_to"><a href="#val-add_time_of_to" class="anchor"></a><code><span><span class="keyword">val</span> add_time_of_to : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>add_time_of_to name f</code> measures the execution time of function <code>f</code> in seconds, and adds it as a float statistic under the given name <code>name</code>. It returns the result of executing <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push_str"><a href="#val-push_str" class="anchor"></a><code><span><span class="keyword">val</span> push_str : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_str name s</code> adds the given string <code>s</code> as a single entry in a string sequence statistic under the given name <code>name</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push_binding"><a href="#val-push_binding" class="anchor"></a><code><span><span class="keyword">val</span> push_binding : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-stat_entry">stat_entry</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_binding name key entry</code> adds the given statistic <code>entry</code> under the given key <code>key</code> in a map statistic under the given name <code>name</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push_string_binding"><a href="#val-push_string_binding" class="anchor"></a><code><span><span class="keyword">val</span> push_string_binding : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_string_binding name key s</code> adds the given string <code>s</code> as a single entry in a string sequence statistic under the given key <code>key</code> in a map statistic under the given name <code>name</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_copy"><a href="#val-get_copy" class="anchor"></a><code><span><span class="keyword">val</span> get_copy : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-t">t</a></span></code></div><div class="spec-doc"><p><code>get_copy ()</code> retrieves a copy of the statistics aggregated in the current environment</p></div></div></div></body></html>
